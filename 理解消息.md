---
title: 理解消息
tags: 基础设施,rabbitmq,消息,分布式,大并发
grammar_cjkRuby: true
---

### 概念：
##### consumer：
译作消费者。就是基于消息做出动作的一方。
##### producer：
译作生产者。就是事件的产生者，消息的发起者。
##### broker：
译作代理人。就是事件的分发者。类似于邮局的概念。

### rabbitmq:
##### channel：
基于tcp的多路复用。减少tcp的建立连接和断开握手，同时也减少服务端占用的资源。
##### queue:
producer直接接触的单元。因为消息的情景大部分是多消费者，甚者是多生产的情况，其中消息投递的情景也可以非常复杂。可以是单一消费，可以是重复消费，rabbitmq基于这些场景，将生产者和消费者分离。生产者直接接触的exchange，消费者直接接触的queue。计算机的名言：没有什么不能通过增加一层间接层解决。这里在生产者和消费者中间增加exchange，queue，这样复杂的投递情况就可以交给exchange和queue的映射关系（binding）来实现，同时，producer也不用管投递的消息有没有被消费，被谁消费的问题，consumer也不用关心消息是谁投递的。
###### caution：
但是这样也引入问题，比如你说怎么追踪消息是被谁消费的，消息是被投递，因为引入的中间层，追踪这种信息会有些困难。由于我们是基于tcp，当然可以查看tcp的连接ip和port来确定这些信息，但是这样也不是绝对的，比如消费者和生产者服务还没有上线，这样就没有tcp连接，也就查不到生产者和消费者是谁。最好的方法，约束使用的人，比如说，使用方都的去登记一下方便记录，亦或者，在rabbitmq的client基础库加入这些信息，所有rabbitmq的使用都经过这个库。
![enter description here](https://www.github.com/PraflyGod/images/raw/master/rabbitmq组件说明.png)


